function buynow(){$(document).on("click",".buynow_wrapper",function(t){t.preventDefault();let e=this,o=$(".color-item-outside.active").data("color-name"),a=$(".color-item-outside.active").data("color-code"),i=$(".size-item.active").data("size-name"),n=$(".color-item-outside.active").data("fcolor"),c=$(".size-item.active").data("size-fname");$(".cart-color-size-box").text("");var r=$(this).data("product-id"),l=$(this).data("product-name"),s=$("#quantity-order").val(),d=format_price($(this).data("product-price")),u={size:{label:i,value:c},color:{label:o,value:a,fcolor:n}},m=$('meta[name="csrf-token"]').attr("content");$(".cart-color-size-name").text(l),$(".cart-quantity-box").text(s),$(".cart-color-size-box").text(`${u.color.label}/${u.size.label}`),$.ajax({url:"/add-to-cart",type:"POST",dataType:"json",data:{id:r,title:l,quantity:s,price:d,options:u,_token:m},success:function(t){window.location.href=$(e).data("link-payment")},error:function(t,e,o){console.error(o),alert("Có lỗi xảy ra khi thêm sản phẩm vào giỏ hàng")}})})}function update_cart(){$.ajax({url:"/get-cart",type:"GET",dataType:"json",success:function(t){$(".sidebar-content").html(t.html),$(".quantity-cart").text(t.quantity)},error:function(t,e,o){console.error(o)}})}function format_price(t){return t.replace(/[.\s₫]/g,"")}$(document).ready(function(){$(document).on("click",".size-item:not(.item-disabled)",function(){$(this).hasClass("sold-out")||$(this).addClass("active").siblings().removeClass("active")}),$(document).on("click",".color-item-outside:not(.item-disabled)",function(t){$(".color-item-outside").removeClass("active"),$(this).addClass("active");let e=$(this).data("color-name");$(".color-name").text(e)}),$(document).on("click",".plus",function(){$(this);var t=$(this).prev("input").val(),e=parseFloat(t)+1;$(this).prev("input").val(e)}),$(document).on("click",".subtract",function(){$(this);var t=$(this).next("input").val();if(t>1){var e=parseFloat(t)-1;$(this).next("input").val(e)}else $(this).next("input").val(1)}),$(".number-only").inputFilter(function(t){return/^\d*$/.test(t)&&(""===t||parseInt(t)<100)}),$(document).on("click",".btn-add-to-cart",function(t){t.preventDefault();let e=$(".color-item-outside.active").data("color-name"),o=$(".color-item-outside.active").data("color-code"),a=$(".color-item-outside.active").data("fcolor"),i=$(".size-item.active").data("size-name"),n=$(".size-item.active").data("size-fname");$(".cart-color-size-box").text("");var c=$(this).data("product-id"),r=$(this).data("product-name"),l=$("#quantity-order").val(),s=format_price($(this).data("product-price")),d={size:{label:i,value:n},color:{label:e,value:o,fcolor:a}},u=$('meta[name="csrf-token"]').attr("content");$(".cart-color-size-name").text(r),$(".cart-quantity-box").text(l),$(".cart-color-size-box").text(`${d.color.label}/${d.size.label}`),$.ajax({url:"/add-to-cart",type:"POST",dataType:"json",data:{id:c,title:r,quantity:l,price:s,options:d,_token:u},success:function(t){$("body").css("overflow","auto"),$(".add-cart-modal").html(t.html),$(".cart-box").show(),showBackdrop(),$("#prd_buynow").modal("hide"),$(".cart-color-size-name").html(t.data.name),$(".thumbnail-cart").attr("src",t.data.image),$(".cart-quantity-box").val(1),update_cart()},error:function(t,e,o){console.error(o),alert("Có lỗi xảy ra khi thêm sản phẩm vào giỏ hàng")}})}),$(".backdrop").on("click",function(t){$(t.target).closest(".sidebar_cart, #openSidebar").length||($(".cart-box").hide(),$("body").css("overflow","auto"))}),$("#prd_buynow").on("hidden.bs.modal",function(){$(".main-carousel-modal").owlCarousel("destroy")}),$(".buy-now").on("click",function(t){t.stopPropagation(),t.preventDefault(),$(".product-slide-wrap").empty();var e="/api/products/"+$(this).data("id");$.ajax({url:e,type:"GET",success:function(t){$(".product-slide-wrap").html(t.html)},error:function(t,e,o){console.error(o)}})}),buynow()}),jQuery.fn.inputFilter=function(t){return this.on("input keydown keyup mousedown mouseup select contextmenu drop",function(){t(this.value)?(this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")?(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd)):this.value=""})};
