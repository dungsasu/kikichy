$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(".btn_add").on("click",function(){$(".btn_submit_add").show(),$(".btn_submit_edit").hide(),$(".title_modal").text("Thêm địa chỉ"),$(".btn_submit_add_edit").text("Thêm"),$("#name").val(""),$("#phone").val(""),$("#address").val(""),$("#provinces").val("0"),$("#districts").val("0"),$("#wards").val("0")}),$("#add_member_address").on("submit",function(t){t.preventDefault();var a=$(this),n=a.serialize();e()&&(t.preventDefault(),$(".btn_submit_edit").css("pointer-events","none"),$.ajax({url:a.attr("action"),method:a.attr("method"),data:n,success:function(t){window.location.href="/tai-khoan/quan-ly-dia-chi"},error:function(t,e,a){console.error("Error submitting form:",a)}}))}),$(".btn_edit").on("click",function(t){t.preventDefault();var e=$(this).data("id");console.log(e),$(".title_modal").text("Chỉnh sửa địa chỉ"),$(".btn_submit_add").hide(),$(".btn_submit_edit").show();var a=$("#member_name_"+e).text().trim(),n=$("#member_phone_"+e).text().trim(),i=$("#address_member_"+e).text().trim(),r={id_item_to_fetch:e};$.ajax({url:"/tai-khoan/quan-ly-dia-chi/lay-dia-chi",method:"GET",data:r,success:function(t){$("#name").val(a),$("#phone").val(n),$("#address").val(i),$("#provinces").val(t.data.city),$("#districts").data("member-district",t.data.district),$("#wards").data("member-ward",t.data.ward),$("#provinces").trigger("change"),1==t.data.set_default?$("#set_default").prop("checked",!0):$("#set_default").prop("checked",!1)},error:function(t,e,a){console.error("Error fetching data:",a),alert("Có lỗi xảy ra. Vui lòng thử lại.")}}),$("#id_address").val(e),$("#name").val($(this).data("name")),$("#phone").val($(this).data("phone")),$("#address").val($(this).data("address")),$("#btn_submit_edit").data("id-edit",e)}),$("#btn_submit_edit").on("click",function(t){t.preventDefault();var a=$(this).data("id-edit");console.log(a);var n=$("#name").val(),i=$("#phone").val(),r=$("#address").val(),o=$("#provinces").val(),d=$("#districts").val(),s=$("#wards").val(),l=$("#set_default").is(":checked")?1:0,c={_token:$('meta[name="csrf-token"]').attr("content"),id_edit:a,member_name:n,member_phone:i,member_address:r,id_province:o,id_district:d,id_ward:s,set_default:l};e()&&(t.preventDefault(),$(".btn_submit_edit").css("pointer-events","none"),$.ajax({url:"/tai-khoan/quan-ly-dia-chi/chinh-sua",method:"POST",data:c,success:function(t){$("#user_address_add").modal("hide"),location.reload()},error:function(t,e,a){console.error("Error fetching data:",a)}}))}),$("#provinces").change(function(){var t=$(this).val();t?($("#districts").removeAttr("disabled").html('<option value="">Quận/Huyện</option>'),$("#wards").attr("disabled","disabled").html('<option value="">Phường/Xã</option>'),$.ajax({url:"/districts/"+t,type:"GET",success:function(t){var e=$("#districts");t.forEach(function(t){e.append(new Option(t.name,t.code))}),$("#districts").val($("#districts").data("member-district")),$("#districts").trigger("change")}})):($("#districts").attr("disabled","disabled").html('<option value="">Quận/Huyện</option>'),$("#wards").attr("disabled","disabled").html('<option value="">Phường/Xã</option>'))}),$(".btn_delete").on("click",function(){var t=$(this).data("id"),e=confirm("Bạn có chắc chắn muốn xóa địa chỉ này không?"),a="/tai-khoan/quan-ly-dia-chi/xoa",n={_token:$('meta[name="csrf-token"]').attr("content"),id_delete:t};console.log(a),console.log("Data to be sent: ",n),e&&$.ajax({url:a,method:"POST",data:n,success:function(t){t.success?(console.log(t),alert("Địa chỉ đã được xóa thành công."),location.reload()):alert("Có lỗi xảy ra. Vui lòng thử lại.")},error:function(t,e,a){console.error("Error deleting data:",a),alert("Có lỗi xảy ra. Vui lòng thử lại.")}})}),$("#districts").change(function(){var t=$(this).val();t?($("#wards").removeAttr("disabled").html('<option value="">Phường/Xã</option>'),$.ajax({url:"/wards/"+t,type:"GET",success:function(t){var e=$("#wards");t.forEach(function(t){e.append(new Option(t.name,t.code))}),$("#wards").val($("#wards").data("member-ward")),$("#wards").trigger("change")}})):$("#wards").attr("disabled","disabled").html('<option value="">Select a ward</option>')});var t=$("#alert_info").val();function e(){return $("label.label_error").prev().remove(),$("label.label_error").remove(),!!notEmpty("name",alert_info1[1])&&(!!notEmpty("phone",alert_info1[5])&&(!!isPhone("phone",alert_info1[6])&&(!!notEmpty("address",alert_info1[12])&&(!!notEmptySelect("provinces","0",alert_info1[15])&&(!!notEmptySelect("districts","0",alert_info1[13])&&!!notEmptySelect("wards","0",alert_info1[14]))))))}alert_info1=t?JSON.parse(t):[]});
